---
import qs from "qs";
import section11CardImage from '../assets/section11Card.svg'
import { Image } from 'astro:assets';

const homePageQuery = qs.stringify(
    {
        populate: {
            cardSection : {
                populate: "*",
            },
        },
    },
    { encodeValuesOnly: true },
);

async function getStrapiData(path: string) {
    const BASE_URL = import.meta.env.PUBLIC_BACKEND_URL;
    const url = new URL(path, BASE_URL);
    url.search = homePageQuery;

    try {
        const res = await fetch(url.href);
        const json = await res.json();
        return json.data;
    } catch (error) {
        console.error("Strapi fetch error:", error);
    }
}

const data = await getStrapiData("/api/home-page");
const cardSection  = data?.cardSection?.find(
    (b: any) => b.__component === "layout.card-section",
);
---

<section class="card-section">
    <div
        style="width: 100%; height: 100%; display: flex; justify-content: center; padding: 150px 0px 120px;"
    >
        <div
            style="width: 100%; height: 100%; max-height: 335px; max-width: 1080px; display: flex; justify-content: start; color: rgb(255, 255, 255); background-color: rgb(33, 131, 237); border-radius: 8px; padding: 40px; flex-direction: column; position: relative;"
        >
            <p
                style="margin-bottom: 16px; color: rgb(255, 255, 255); font-family: Inter; font-size: 32px; font-style: normal; font-weight: 600; line-height: normal; width: 40%;"
            >
                {cardSection?.cardHeading}
            </p><p
                style="margin-bottom: 56px; color: rgb(255, 255, 255); font-family: Inter; font-size: 16px; font-style: normal; font-weight: 400; line-height: 150%; width: 40%;"
            >
                {cardSection?.cardPara}
            </p><button
                style="padding: 14px 32px; width: 100%; max-width: 320px; border: 1px solid rgb(255, 255, 255); border-radius: 100px; background: transparent; font-family: Inter; font-size: 16px; font-style: normal; font-weight: 600; line-height: normal; cursor: pointer;"
                >{cardSection?.cardButtonContent}</button
            ><Image
                alt="bannerPattern"
                src={section11CardImage}
                style="position: absolute; top: 0px; right: 0px;"
            />
        </div>
    </div>
</section>

<style>
    /* Section Wrapper */
    .impact-section {
        text-align: center;
        padding: 60px 20px;
        background: rgb(246, 246, 247);
        font-family: Arial, sans-serif;
    }

    .impact-section h2 {
        font-size: 32px;
        margin-bottom: 60px;
        font-weight: 600;
    }

    /* Grid Layout */
    .impact-grid {
        display: flex;
        justify-content: center;
        gap: 80px;
        flex-wrap: wrap;
    }

    /* Individual Item */
    .impact-item {
        max-width: 250px;
        padding: 0 20px;
        border-right: 1px solid #dcdcdc;
    }

    .impact-item:last-child {
        border-right: none;
    }

    .impact-item h3 {
        font-size: 48px;
        color: #1a73e8;
        margin: 0 0 15px;
    }

    .impact-item p {
        font-size: 16px;
        color: #555;
        line-height: 1.5;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .impact-grid {
            flex-direction: column;
            gap: 40px;
        }

        .impact-item {
            border-right: none;
            border-bottom: 1px solid #dcdcdc;
            padding-bottom: 20px;
        }

        .impact-item:last-child {
            border-bottom: none;
        }
    }
</style>
